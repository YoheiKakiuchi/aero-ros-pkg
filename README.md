# aero-ros-pkg

[![Build Status](https://travis-ci.org/seed-solutions/aero-ros-pkg.svg?branch=master)](https://travis-ci.org/seed-solutions/aero-ros-pkg)

## Pre-requirement

### Install ROS

[Install ROS kinetic]( http://wiki.ros.org/kinetic/Installation/Ubuntu ) [Recommended]

or

[Install ROS indigo]( http://wiki.ros.org/indigo/Installation/Ubuntu )

```
sudo apt-get install ros-${ROS_DISTRO}-desktop-full
```

### Setup catkin workspace

```
sudo apt-get install python-wstool python-catkin-tools
mkdir -p ~/ros/${ROS_DISTRO}
cd ~/ros/${ROS_DISTRO}
wstool init src
catkin init
catkin build
source ~/ros/${ROS_DISTRO}/devel/setup.bash
```

### source setup.bash in ~/.bashrc

Please add the following line to ~/.bashrc
```
source ~/ros/indigo/devel/setup.bash
```

## Install

### Clone repository and Setup ROS binary packages

```
cd ~/ros/${ROS_DISTRO}/src
wstool set aero-ros-pkg https://github.com/seed-solutions/aero-ros-pkg.git --git
wstool up aero-ros-pkg
cd ~/ros/${ROS_DISTRO}
rosdep install -y -r --from-paths src --ignore-src
```
You may need ``sudo rosdep init`` and ``rosdep update`` before
``rosdep install``. Please follow the terminal message.

### Build packge

#### Build aero_description

```
cd aero-ros-pkg
catkin build aero_description
soure ~/.bashrc
```

#### Setup aero_startup

In the initial stage, `aero_startup` is not ros package, it has no `CMakeLists.txt`.
`CMakeLists.txt` and some controller modules are generated by `aero_description/setup.sh`.
`setup.sh` requires robot directory as an argument e.g. `setup.sh typeF`.

```
roscd aero_description
./setup.sh typeF  # including catkin build aero_startup
source ~/.bashrc
```

If you need clean up `aero_startup`, please use `aero_description/clean.sh`.

## Control AERO

### Setup udev

T.B.D.

### Run controllers

```
roslaunch aero_startup aero_bringup.launch
```

### View Robot Model

```
rosrun rviz rviz
```

then add RobotModel

## Simulation

See [aero_gazebo](https://github.com/seed-solutions/aero-ros-pkg/blob/master/aero_gazebo/README.md)


## Samples

### Build Samples

```
catkin build aero_samples
```

### Run Minimum Sample

```
rosrun aero_samples minimum_sample_node
```

### Control from Command Line

#### Move Torso

```
rostopic pub /lifter_controller/command trajectory_msgs/JointTrajectory "header:
  seq: 0
  stamp:
    secs: 0
    nsecs: 0
  frame_id: ''
joint_names:
- 'ankle_joint'
- 'knee_joint'
points:
- positions: [0.5, -0.5]
  velocities: [0, 0]
  accelerations: [0, 0]
  effort: [0, 0]
  time_from_start: {secs: 3, nsecs: 0}"
```

#### Move hands
~~~
## Open
rosservice call /aero_hand_controller "{hand: $(python -c 'import aero_startup.srv; print aero_startup.srv.HandControlRequest.HAND_RIGHT'), command: $(python -c 'import aero_startup.srv; print aero_startup.srv.HandControlRequest.COMMAND_UNGRASP'), power: 0, time_sec: 0}"

## Grasp
rosservice call /aero_hand_controller "{hand: $(python -c 'import aero_startup.srv; print aero_startup.srv.HandControlRequest.HAND_RIGHT'), command: $(python -c 'import aero_startup.srv; print aero_startup.srv.HandControlRequest.COMMAND_GRASP'), power: 0, time_sec: 1.0}"

## Angle
rosservice call /aero_hand_controller "{hand: $(python -c 'import aero_startup.srv; print aero_startup.srv.HandControlRequest.HAND_RIGHT'), command: $(python -c 'import aero_startup.srv; print aero_startup.srv.HandControlRequest.COMMAND_GRASP_ANGLE'), power: 0, time_sec: 1.0, larm_angle: 0.5, rarm_angle: 0.5}"
~~~

### Writing Codes

see `aero_samples` and `aero_std` documentation
